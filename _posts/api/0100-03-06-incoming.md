---
layout: null
published: true
title: Incoming
abstract: The Incoming module contains functions that are generally used when processing incoming data such as during a post, put, or a delete.
author: Bediako George, Serena Lei
categories: api
---

# Introduction
The Incoming module contains functions for processing incoming data. This includes data conversion and validation; data encryption, audit and persistence.

## - CreateKey (resourceName, guid)
Creates a com.google.appengine.api.datastore.Key via the KeyFactory.

    var in = require('airlift/incoming'), u = require('airlift/util');
    var key = in.createKey('person', u.guid(12));
    u.println(key.getName()); //c30215c36032
    
## - CreateEntity (resourceName, guid)
Creates a com.google.appengine.api.datastore.Entity.  Relies on createKey.

    var in = require('airlift/incoming'), u = require('airlift/util');
    var entity = in.createEntity('person', u.guid(12));
    u.println(entity.getKind()); //person
   
## - Bookkeeping (entity, userid, postDate, putDate)
Populates the entity object with the bookkeeping metadata that describes when this object was created and by whom it was created.  If userId is not provided and cannot be determined systematically 'user id not provided' is recorded.  If postDate is not provided the current date and time is used instead.  If putDate is not provided the postDate is used instead.

    var in = require('airlift/incoming'), u = require('airlift/util');
    var person = in.createEntity('person', u.guid(12));
    in.bookkeeping(person, 'bediako', u.createDate());
    
## - Entify (entity, value, attributeName)
Function designed to be used with resource.each, it converts a resource's attribute values into a property map values on an entity object.

    u = require('airlift/util');
	
    var person = {};
    person.id = u.guid(12);
    person.fullName = "Kwame Mtume"
    person.age = 27;
    
    var in = require('airlift/incoming'), res = require('airlift/resource'); 
    var entity = in.createEntity('person', person.id);
    res.each('person', person, in.entify.partial(entity));
    
## - Encrypt (entity, value, attributeName)
Function designed to be used with resource.each, it converts a resource's sensitive attribute values into encrypted property map values on an entity object.

    u = require('airlift/util');
	
    var person = {};
    person.id = u.guid(12);
    person.fullName = "Kwame Mtume"
    person.age = 27;
    
    var in = require('airlift/incoming'), res = require('airlift/resource'); 
    var entity = in.createEntity('person', person.id);
    res.each('person', person, in.encrypt.partial(entity));
    
## - Convert (value, attributeName, resource)
Function designed to be used with resource.each, it converts a request parameter values into a property map values on a JavaScript object.  It relies on Airlift automatically setting the web context object that resource.each relies on. 

    u = require('airlift/util');
	
    var person = {};
    
    var in = require('airlift/incoming'), res = require('airlift/resource'); 
    res.each('person', person, in.convert);

## - Validate (value, attributeName, resource, metadata)
Function designed to be used with resource.each, it verifies that the resource's property values are in line with the constraints outlined in the attribute and resource metadata. Use resource.watch to get hold of the errors at the end of the validation.

    u = require('airlift/util');
	
    var person = {};
    person.id = u.guid(12);
    person.fullName = "Kwame Mtume"
    person.age = 27;
   
    var errors;
    
    var in = require('airlift/incoming'), res = require('airlift/resource'); 
    res.each('person', person, res.sequence(in.validate, res.watch(
        function() { 
            errors = this.allErrors(); 
        }
    )));
